<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Candlescope FinanceBoard</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=DM+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>

    <!-- Styles -->
    <link rel="stylesheet" href="styles/base.css" />
    <link rel="stylesheet" href="styles/layout.css" />
    <link rel="stylesheet" href="styles/components.css" />
    <link rel="stylesheet" href="styles/tables.css" />
    <link rel="stylesheet" href="styles/modal.css" />
    <link rel="stylesheet" href="styles/intro.css" />
    <link rel="stylesheet" href="styles/goals.css" />
    <link rel="stylesheet" href="styles/settings.css" />
    <link rel="stylesheet" href="styles/docs.css" />
    <link rel="stylesheet" href="styles/lockscreen.css" />
    <link rel="stylesheet" href="styles/print.css" />
  </head>
  <body>
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SPLASH ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="splash">
      <div class="splash-logo-wrap">
        <div class="splash-ring"></div>
        <div class="splash-ring"></div>
        <div class="splash-ring"></div>
        <div class="splash-logo-box">
          <img src="./images/CandleScope.webp" alt="CS" />
        </div>
      </div>
      <div class="splash-wordmark">
        <div class="splash-title">Candlescope FinanceBoard</div>
        <div class="splash-sub">PERS√ñNLICHE FINANZEN ¬∑ 2026</div>
      </div>
      <div class="splash-bar-wrap">
        <div class="splash-bar"></div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TUTORIAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- Tutorial Overlay: nur dunkler Backdrop, kein Kind-Element -->
    <div id="tutorialOverlay"></div>

    <!-- Tutorial Box: eigenst√§ndig, immer oben -->
    <div id="tutorialBox">
      <div class="tut-progress-bar">
        <div
          class="tut-progress-fill"
          id="tutProgressFill"
          style="width: 0%"
        ></div>
      </div>
      <div class="tut-visual">
        <div class="tut-visual-bg"></div>
        <div class="tut-visual-lines"></div>
        <div class="tut-skip-btn" onclick="closeTutorial()">√úberspringen</div>
        <div class="tut-step-badge" id="tutStepBadge">1 / 9</div>
        <div class="tut-visual-icon" id="tutIcon">üëã</div>
      </div>
      <div class="tut-content">
        <div class="tut-tag" id="tutTag">Willkommen</div>
        <div class="tut-title" id="tutTitle">Willkommen</div>
        <div class="tut-body" id="tutBody"></div>
        <div class="tut-footer">
          <div class="tut-dots" id="tutDots"></div>
          <div class="tut-nav">
            <button class="tut-btn back" id="tutBackBtn" onclick="tutBack()">
              ‚Üê Zur√ºck
            </button>
            <button class="tut-btn next" id="tutNextBtn" onclick="tutNext()">
              Weiter ‚Üí
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Hintergrund -->
    <div class="bg"></div>

    <div class="shell">
      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <aside class="sidebar">
        <div class="logo">
          <div class="logo-icon">
            <img
              src="./images/CandleScope.webp"
              width="22"
              height="22"
              alt="CS"
              style="border-radius: 4px"
            />
          </div>
          <div>
            <div class="logo-text">Candlescope</div>
            <div class="logo-sub">2026 ¬∑ FinanceBoard</div>
          </div>
        </div>
        <div
          id="sidebarGreeting"
          style="
            display: none;
            padding: 6px 16px 0;
            font-size: 0.7em;
            color: var(--text3);
            font-style: italic;
          "
        ></div>

        <nav>
          <div class="nav-section">Dashboard</div>
          <div class="nav-item active" onclick="nav(this, 'dashboard')">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="3" width="7" height="9" />
              <rect x="14" y="3" width="7" height="5" />
              <rect x="14" y="12" width="7" height="9" />
              <rect x="3" y="16" width="7" height="5" />
            </svg>
            √úbersicht
          </div>
          <div class="nav-item" onclick="nav(this, 'posten')">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="8" y1="6" x2="21" y2="6" />
              <line x1="8" y1="12" x2="21" y2="12" />
              <line x1="8" y1="18" x2="21" y2="18" />
              <line x1="3" y1="6" x2="3.01" y2="6" />
              <line x1="3" y1="12" x2="3.01" y2="12" />
              <line x1="3" y1="18" x2="3.01" y2="18" />
            </svg>
            Ums√§tze
          </div>
          <div class="nav-section">Planung</div>
          <div class="nav-item" onclick="nav(this, 'jahr')">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="4" width="18" height="18" rx="2" />
              <line x1="16" y1="2" x2="16" y2="6" />
              <line x1="8" y1="2" x2="8" y2="6" />
              <line x1="3" y1="10" x2="21" y2="10" />
            </svg>
            Jahres√ºbersicht
          </div>
          <div class="nav-item" onclick="nav(this, 'vertraege')">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" />
              <polyline points="14 2 14 8 20 8" />
              <line x1="16" y1="13" x2="8" y2="13" />
              <line x1="16" y1="17" x2="8" y2="17" />
            </svg>
            Vertr√§ge
            <span class="nav-badge" id="contractBadge" style="display: none"
              >!</span
            >
          </div>
          <div class="nav-section">Ziele & Analyse</div>
          <div class="nav-item" onclick="nav(this, 'goals')">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <circle cx="12" cy="12" r="6" />
              <circle cx="12" cy="12" r="2" />
            </svg>
            Sparziele
          </div>
          <div class="nav-section">System</div>
          <div class="nav-item" onclick="nav(this, 'docs')">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M2 3h6a4 4 0 014 4v14a3 3 0 00-3-3H2z" />
              <path d="M22 3h-6a4 4 0 00-4 4v14a3 3 0 013-3h7z" />
            </svg>
            √úber diese App
          </div>
          <div class="nav-item" onclick="nav(this, 'settings')">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="3" />
              <path
                d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"
              />
            </svg>
            Einstellungen
          </div>
        </nav>

        <div class="sidebar-foot">
          <div class="tut-trigger" onclick="openTutorial(0)">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <circle cx="12" cy="12" r="10" />
              <path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3" />
              <line x1="12" y1="17" x2="12.01" y2="17" />
            </svg>
            Hilfe & Tutorial
          </div>
          <div class="save-status" style="margin-top: 8px">
            <div class="save-dot" id="saveDot"></div>
            <span id="saveLabel">autosave ¬∑ on</span>
          </div>
        </div>
      </aside>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TOPBAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <header class="topbar">
        <div>
          <div class="topbar-title" id="pageTitle">Dashboard</div>
        </div>
        <div class="topbar-right">
          <div class="topbar-date" id="todayStr">‚Äî</div>
          <div class="icon-btn pdf" onclick="exportPDF()" title="PDF Export">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" />
              <polyline points="14 2 14 8 20 8" />
              <line x1="16" y1="13" x2="8" y2="13" />
            </svg>
            PDF
          </div>
          <div class="icon-btn" onclick="exportAll()" title="JSON exportieren">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
              <polyline points="7 10 12 15 17 10" />
              <line x1="12" y1="15" x2="12" y2="3" />
            </svg>
            Export
          </div>
          <div class="icon-btn" onclick="importAll()" title="JSON importieren">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
              <polyline points="17 8 12 3 7 8" />
              <line x1="12" y1="3" x2="12" y2="15" />
            </svg>
            Import
          </div>
          <div
            class="icon-btn"
            id="btnUmbuchung"
            onclick="openModal(null, 'transfer')"
            title="Umbuchung"
          >
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M7 16V4m0 0L3 8m4-4l4 4M17 8v12m0 0l4-4m-4 4l-4-4" />
            </svg>
            Umbuchung
          </div>
          <div class="icon-btn primary" onclick="openModal()">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2.5"
              width="12"
              height="12"
            >
              <line x1="12" y1="5" x2="12" y2="19" />
              <line x1="5" y1="12" x2="19" y2="12" />
            </svg>
            Neuer Posten
          </div>
        </div>
      </header>

      <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MAIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
      <main class="main">
        <!-- DASHBOARD -->
        <div class="page active" id="p-dashboard">
          <div class="kpi-row" id="kpiRow"></div>
          <div class="dash-grid">
            <div class="dash-left">
              <div class="panel">
                <div class="panel-head">
                  <div>
                    <div class="panel-title">Zahlungs√ºbersicht</div>
                    <div class="panel-sub" id="cockpitSub">
                      Bis n√§chstem Zahltag
                    </div>
                  </div>
                  <div class="panel-tag" id="cockpitTag">‚Äî</div>
                </div>
                <div class="cockpit-cols" id="cockpitCols"></div>
              </div>
              <div class="panel">
                <div class="panel-head">
                  <div>
                    <div class="panel-title">Jahresverlauf 2026</div>
                    <div class="panel-sub">Monatliche Einnahmen & Ausgaben</div>
                  </div>
                  <div class="panel-tag">12 Monate</div>
                </div>
                <div class="panel-body">
                  <div class="chart-c"><canvas id="barChart"></canvas></div>
                </div>
              </div>
            </div>
            <div class="dash-right">
              <div class="panel" id="kontenPanel">
                <div class="panel-head">
                  <div class="panel-title">Konten</div>
                  <div class="panel-tag">Stand heute</div>
                </div>
                <div class="acc-list" id="accList"></div>
                <div class="income-row">
                  <div class="income-lbl">Monatseingang</div>
                  <div class="income-inp-wrap">
                    <input
                      class="income-inp"
                      id="monthlyIncome"
                      type="text"
                      placeholder="0,00"
                      oninput="setMonthlyIncome(this.value)"
                    />
                    <span class="income-sfx">‚Ç¨</span>
                  </div>
                </div>
              </div>
              <div class="panel">
                <div class="panel-head">
                  <div class="panel-title">Ausgabenverteilung</div>
                  <div class="panel-tag">√ò / Monat</div>
                </div>
                <div class="panel-body">
                  <div class="donut-wrap">
                    <canvas id="donutChart"></canvas>
                    <div class="donut-center">
                      <div class="donut-center-val" id="donutTotal">‚Äî</div>
                      <div class="donut-center-lbl">Gesamt</div>
                    </div>
                  </div>
                  <div class="donut-legend" id="donutLegend"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- UMS√ÑTZE -->
        <div class="page" id="p-posten">
          <div class="ph">
            <div>
              <div class="ph-title">Ums√§tze</div>
              <div class="ph-sub" id="postenCount">‚Äî</div>
            </div>
            <div class="btn-row">
              <button class="btn" onclick="openModal(null, 'transfer')">
                ‚áÑ Umbuchung
              </button>
              <button class="btn primary" onclick="openModal()">
                + Neuer Posten
              </button>
            </div>
          </div>
          <div class="panel">
            <div class="panel-head">
              <div class="panel-title">Alle festen Posten</div>
              <div
                id="postenSaldo"
                style="font-family: var(--mono); font-size: 0.8em"
              ></div>
            </div>
            <div class="tbl-wrap">
              <table>
                <thead>
                  <tr id="postenThead">
                    <th class="sortable" data-k="name" style="min-width: 160px">
                      <span class="th-inner"
                        >Bezeichnung <span class="sort-arr">‚Üï</span></span
                      >
                    </th>
                    <th class="sortable" data-k="type">
                      <span class="th-inner"
                        >Typ <span class="sort-arr">‚Üï</span></span
                      >
                    </th>
                    <th class="sortable" data-k="interval">
                      <span class="th-inner"
                        >Intervall <span class="sort-arr">‚Üï</span></span
                      >
                    </th>
                    <th class="sortable" data-k="due">
                      <span class="th-inner"
                        >F√§llig <span class="sort-arr">‚Üï</span></span
                      >
                    </th>
                    <th class="sortable" data-k="accountId">
                      <span class="th-inner"
                        >Konto <span class="sort-arr">‚Üï</span></span
                      >
                    </th>
                    <th class="sortable r" data-k="amount">
                      <span class="th-inner"
                        >Betrag <span class="sort-arr">‚Üï</span></span
                      >
                    </th>
                    <th class="r">√ò/Mon</th>
                    <th>Laufzeit</th>
                    <th class="r">Aktion</th>
                  </tr>
                </thead>
                <tbody id="postenBody"></tbody>
                <tfoot id="postenFoot"></tfoot>
              </table>
            </div>
          </div>
        </div>

        <!-- JAHRES√úBERSICHT -->
        <div class="page" id="p-jahr">
          <div class="ph">
            <div>
              <div class="ph-title">Jahres√ºbersicht 2026</div>
              <div class="ph-sub">Monatliche Saldi ‚Äî feste Posten</div>
            </div>
          </div>
          <div class="year-grid" id="yearGrid"></div>
        </div>

        <!-- VERTR√ÑGE -->
        <div class="page" id="p-vertraege">
          <div class="ph">
            <div>
              <div class="ph-title">Vertr√§ge & Laufzeiten</div>
              <div class="ph-sub">Alle Posten mit Vertragsdaten</div>
            </div>
            <button class="btn primary" onclick="openModal()">
              + Neuer Posten
            </button>
          </div>
          <div class="panel" id="contractList"></div>
        </div>

        <!-- GOALS -->
        <div class="page" id="p-goals"></div>

        <!-- SETTINGS -->
        <div class="page" id="p-settings"></div>
        <div class="page" id="p-docs"></div>
      </main>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: POSTEN / TRANSFER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div class="overlay" id="modalOverlay" onclick="overlayClick(event)">
      <div class="modal">
        <div class="modal-header">
          <h3 id="modalH">Neuer Posten</h3>
          <div class="modal-close" onclick="closeModal()">‚úï</div>
        </div>

        <!-- Tabs -->
        <div class="modal-tabs">
          <div
            class="modal-tab active"
            data-tab="posten"
            onclick="switchModalTab('posten')"
          >
            Posten
          </div>
          <div
            class="modal-tab"
            data-tab="transfer"
            onclick="switchModalTab('transfer')"
          >
            Umbuchung
          </div>
        </div>

        <!-- TAB: POSTEN -->
        <div class="modal-pane active" id="mpane-posten">
          <div class="frow c2">
            <div class="fg">
              <label>Bezeichnung</label>
              <input
                id="fName"
                type="text"
                placeholder="z.B. Miete, Spotify..."
              />
            </div>
            <div class="fg">
              <label>Typ</label>
              <select id="fType">
                <option value="ausgabe" selected>Ausgabe</option>
                <option value="einnahme">Einnahme</option>
              </select>
            </div>
          </div>
          <div class="frow c3">
            <div class="fg">
              <label>Betrag ‚Ç¨</label>
              <input
                id="fAmount"
                type="number"
                step="0.01"
                placeholder="0.00"
              />
            </div>
            <div class="fg">
              <label>Intervall</label>
              <select id="fInterval">
                <option value="monatl.">Monatlich</option>
                <option value="viertelj.">Viertelj√§hrlich</option>
                <option value="halbj√§hrl.">Halbj√§hrlich</option>
                <option value="j√§hrl.">J√§hrlich</option>
                <option value="einmalig">Einmalig</option>
              </select>
            </div>
            <div class="fg">
              <label>F√§llig (Tag)</label>
              <input
                id="fDue"
                type="number"
                min="1"
                max="31"
                placeholder="1‚Äì31"
              />
            </div>
          </div>
          <div class="frow c2">
            <div class="fg">
              <label>Konto</label>
              <select id="fAccount">
                <!-- wird per JS bef√ºllt -->
              </select>
            </div>
            <div class="fg">
              <label>Notiz</label>
              <input
                id="fNote"
                type="text"
                placeholder="z.B. K√ºndigungsfrist..."
              />
            </div>
          </div>
          <div class="frow c2">
            <div class="fg">
              <label>Vertrag Start</label>
              <input id="fStart" type="date" />
            </div>
            <div class="fg">
              <label>Vertrag Ende</label>
              <input id="fEnd" type="date" />
            </div>
          </div>
          <div class="modal-actions">
            <button
              class="btn danger"
              id="postenModalDelete"
              onclick="deletePosten()"
              style="display: none; margin-right: auto"
            >
              L√∂schen
            </button>
            <button class="btn" onclick="closeModal()">Abbrechen</button>
            <button class="btn primary" onclick="savePosten()">
              Speichern
            </button>
          </div>
        </div>

        <!-- TAB: UMBUCHUNG -->
        <div class="modal-pane" id="mpane-transfer">
          <div class="frow c2">
            <div class="fg">
              <label>Von Konto</label>
              <select id="fTrfFrom">
                <!-- per JS -->
              </select>
            </div>
            <div class="fg">
              <label>Nach Konto</label>
              <select id="fTrfTo">
                <!-- per JS -->
              </select>
            </div>
          </div>
          <div class="transfer-arrow">‚áÖ</div>
          <div class="frow c2">
            <div class="fg">
              <label>Betrag ‚Ç¨</label>
              <input
                id="fTrfAmount"
                type="number"
                step="0.01"
                placeholder="0.00"
              />
            </div>
            <div class="fg">
              <label>Datum</label>
              <input id="fTrfDate" type="date" />
            </div>
          </div>
          <div class="frow">
            <div class="fg">
              <label>Notiz</label>
              <input
                id="fTrfNote"
                type="text"
                placeholder="z.B. Monatsr√ºcklage..."
              />
            </div>
          </div>
          <div class="modal-actions">
            <button
              class="btn danger"
              id="trfModalDelete"
              onclick="deleteTransfer()"
              style="display: none; margin-right: auto"
            >
              L√∂schen
            </button>
            <button class="btn" onclick="closeModal()">Abbrechen</button>
            <button class="btn primary" onclick="saveTransfer()">
              Speichern
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: KONTO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div
      class="overlay"
      id="accModalOverlay"
      onclick="if (event.target === this) closeAccountModal();"
    >
      <div class="modal">
        <div class="modal-header">
          <h3 id="accModalTitle">Neues Konto</h3>
          <div class="modal-close" onclick="closeAccountModal()">‚úï</div>
        </div>
        <div class="frow c2">
          <div class="fg">
            <label>Kontoname</label>
            <input id="accFLabel" type="text" placeholder="z.B. DKB Giro" />
          </div>
          <div class="fg">
            <label>Kontoart</label>
            <select id="accFType" class="acc-type-select">
              <option value="girokonto">Girokonto</option>
              <option value="kreditkarte">Kreditkarte</option>
              <option value="tagesgeld">Tagesgeld</option>
              <option value="sparkonto">Sparkonto</option>
              <option value="depot">Depot</option>
              <option value="festgeld">Festgeld</option>
              <option value="sonstiges">Sonstiges</option>
            </select>
          </div>
        </div>
        <div class="frow c2">
          <div class="fg">
            <label
              >Beschreibung
              <span style="opacity: 0.5; font-size: 0.85em"
                >(optional)</span
              ></label
            >
            <input id="accFSub" type="text" placeholder="z.B. Hauptkonto" />
          </div>
          <div class="fg">
            <label>Aktueller Stand ‚Ç¨</label>
            <input id="accFBalance" type="text" placeholder="0,00" />
          </div>
        </div>
        <!-- Nummernfeld: wechselt je nach Kontoart -->
        <div class="frow" id="accNumberRow">
          <!-- wird per JS bef√ºllt via updateAccNumberFields() -->
        </div>
        <div class="frow">
          <div class="fg">
            <label>Farbe</label>
            <div class="color-row" id="accColorRow"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button
            class="btn danger"
            id="accModalDelete"
            onclick="deleteAccount()"
            style="display: none; margin-right: auto"
          >
            L√∂schen
          </button>
          <button class="btn" onclick="closeAccountModal()">Abbrechen</button>
          <button class="btn primary" onclick="saveAccountModal()">
            Speichern
          </button>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: SPARZIEL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div
      class="overlay"
      id="goalModalOverlay"
      onclick="if (event.target === this) closeGoalModal();"
    >
      <div class="modal">
        <div class="modal-header">
          <h3 id="goalModalTitle">Neues Ziel</h3>
          <div class="modal-close" onclick="closeGoalModal()">‚úï</div>
        </div>
        <div class="frow c2">
          <div class="fg">
            <label>Bezeichnung</label>
            <input
              id="gfName"
              type="text"
              placeholder="z.B. Notgroschen, Urlaub..."
            />
          </div>
          <div class="fg">
            <label>Icon</label>
            <div class="goal-icon-picker" id="goalIconPicker">
              <span class="goal-icon-opt" onclick="selectGoalIcon('üéØ')"
                >üéØ</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üèñÔ∏è')"
                >üèñÔ∏è</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üöó')"
                >üöó</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üè†')"
                >üè†</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üíª')"
                >üíª</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('‚úàÔ∏è')"
                >‚úàÔ∏è</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üí∞')"
                >üí∞</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üìà')"
                >üìà</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üéì')"
                >üéì</span
              >
              <span class="goal-icon-opt" onclick="selectGoalIcon('üíç')"
                >üíç</span
              >
            </div>
          </div>
        </div>
        <div class="frow c2">
          <div class="fg">
            <label>Zielbetrag ‚Ç¨</label>
            <input id="gfTarget" type="text" placeholder="5.000,00" />
          </div>
          <div class="fg">
            <label>Bereits gespart ‚Ç¨</label>
            <input id="gfCurrent" type="text" placeholder="0,00" />
          </div>
        </div>
        <div class="frow c2">
          <div class="fg">
            <label>Monatliche Sparrate ‚Ç¨</label>
            <input id="gfRate" type="text" placeholder="200,00" />
          </div>
          <div class="fg">
            <label>Zieldatum</label>
            <input id="gfDeadline" type="date" />
          </div>
        </div>
        <div class="frow">
          <div class="fg">
            <label>Farbe</label>
            <div class="color-row" id="goalColorRow"></div>
          </div>
        </div>
        <div class="modal-actions">
          <button
            class="btn danger"
            id="goalModalDelete"
            style="display: none; margin-right: auto"
            onclick="deleteGoal()"
          >
            L√∂schen
          </button>
          <button class="btn" onclick="closeGoalModal()">Abbrechen</button>
          <button class="btn primary" onclick="saveGoal()">Speichern</button>
        </div>
      </div>
    </div>

    <!-- PDF Container -->
    <div id="pdf-root"></div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOCKSCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="lockScreen">
      <div id="lockBox">
        <div class="lock-logo">
          <div class="lock-logo-box">
            <img src="./images/CandleScope.webp" alt="CS" />
          </div>
        </div>
        <div id="lockTitle">FinanceBoard entsperren</div>
        <div id="lockSubtitle">Bitte Passwort eingeben um fortzufahren</div>
        <div class="lock-inp-wrap">
          <input
            class="lock-inp"
            id="lockPw"
            type="password"
            placeholder="Passwort"
            onkeydown="lockKeydown(event)"
          />
          <span class="lock-inp-eye" onclick="toggleLockPwVis('lockPw', this)"
            >üëÅ</span
          >
        </div>
        <div class="lock-inp-wrap" id="lockConfirmRow" style="display: none">
          <input
            class="lock-inp"
            id="lockPwConfirm"
            type="password"
            placeholder="Passwort wiederholen"
            onkeydown="lockKeydown(event)"
          />
          <span
            class="lock-inp-eye"
            onclick="toggleLockPwVis('lockPwConfirm', this)"
            >üëÅ</span
          >
        </div>
        <div id="lockError"></div>
        <button id="lockBtn">Entsperren</button>
        <div class="lock-hint">Candlescope FinanceBoard ¬∑ Alle Daten lokal</div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê JS MODULE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/nav.js"></script>
    <script src="js/accounts.js"></script>
    <script src="js/modal.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/umsaetze.js"></script>
    <script src="js/jahresuebersicht.js"></script>
    <script src="js/vertraege.js"></script>
    <script src="js/io.js"></script>
    <script src="js/intro.js"></script>
    <script src="js/lockscreen.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/goals.js"></script>
    <script src="js/docs.js"></script>
    <script>
      // ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
      document.addEventListener("DOMContentLoaded", () => {
        loadSettings();
        checkLock();
        const had = hydrate();
        if (!had) seedData();
        renderDashboard();
        runSplash();
        checkFirstVisit();
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            closeModal();
            closeAccountModal();
            closeGoalModal();
            closeTutorial();
          }
        });
      });

      function toggleLockPwVis(id, btn) {
        const inp = document.getElementById(id);
        if (!inp) return;
        inp.type = inp.type === "password" ? "text" : "password";
        btn.textContent = inp.type === "password" ? "üëÅ" : "üôà";
      }
    </script>
  </body>
</html>
